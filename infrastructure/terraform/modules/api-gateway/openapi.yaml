swagger: "2.0"
info:
  title: Cervelet API Gateway
  description: Single public entry point for the Cervelet serverless application
  version: 1.0.0
schemes:
  - https
produces:
  - application/json

securityDefinitions:
  api_key:
    type: apiKey
    name: x-api-key
    in: header

security:
  - api_key: []

x-google-backend:
  address: ${backend_url}
  deadline: 30.0

paths:
  /discord/webhook:
    post:
      summary: Discord webhook endpoint
      operationId: discordWebhook
      security:
        - api_key: []
      responses:
        200:
          description: Success
        400:
          description: Bad Request
        401:
          description: Unauthorized
        500:
          description: Internal Server Error

  /**:
    get:
      summary: Catch-all GET
      operationId: catchAllGet
      security:
        - api_key: []
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Origin:
              type: string
              default: "*"
            Access-Control-Allow-Headers:
              type: string
              default: "Content-Type, Authorization, x-api-key"
            Access-Control-Allow-Methods:
              type: string
              default: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
    post:
      summary: Catch-all POST
      operationId: catchAllPost
      security:
        - api_key: []
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Origin:
              type: string
              default: "*"
            Access-Control-Allow-Headers:
              type: string
              default: "Content-Type, Authorization, x-api-key"
            Access-Control-Allow-Methods:
              type: string
              default: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
    put:
      summary: Catch-all PUT
      operationId: catchAllPut
      security:
        - api_key: []
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Origin:
              type: string
              default: "*"
            Access-Control-Allow-Headers:
              type: string
              default: "Content-Type, Authorization, x-api-key"
            Access-Control-Allow-Methods:
              type: string
              default: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
    delete:
      summary: Catch-all DELETE
      operationId: catchAllDelete
      security:
        - api_key: []
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Origin:
              type: string
              default: "*"
            Access-Control-Allow-Headers:
              type: string
              default: "Content-Type, Authorization, x-api-key"
            Access-Control-Allow-Methods:
              type: string
              default: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
    patch:
      summary: Catch-all PATCH
      operationId: catchAllPatch
      security:
        - api_key: []
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Origin:
              type: string
              default: "*"
            Access-Control-Allow-Headers:
              type: string
              default: "Content-Type, Authorization, x-api-key"
            Access-Control-Allow-Methods:
              type: string
              default: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
    options:
      summary: Catch-all OPTIONS
      operationId: catchAllOptions
      # Preflight must not require API key
      security: []
      responses:
        200:
          description: Success
          headers:
            Access-Control-Allow-Origin:
              type: string
              default: "*"
            Access-Control-Allow-Headers:
              type: string
              default: "Content-Type, Authorization, x-api-key"
            Access-Control-Allow-Methods:
              type: string
              default: "GET,POST,PUT,PATCH,DELETE,OPTIONS"
